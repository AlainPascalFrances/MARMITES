# MARMITES
MARMITES (MM) is a transient and distributed model of the land surface and the soil zone that is coupled with the groundwater model MODFLOW (MF). The MARMITES-MODFLOW coupled model (MM-MF) allows to compute spatio-temporally the water balance at the catchment scale. The main features and novelties of this approach are: (i) spatio-temporal quantification of sub-surface water fluxes; (ii) sourcing of the subsurface water fluxes, i.e. the allocation of these water fluxes to unsaturated or saturated zones; and (iii) partitioning of the evapotranspiration into evaporation and transpiration.

MM is composed by one surface component (MARMITESsurf, in short MMsurf) and one soil zone component (MARMITESsoil, in short MMsoil). The first step in MM-MF modeling is to compute the driving forces of the hydrological cycle, i.e. rainfall and potential evapotranspiration. This is handled by MMsurf that requires as input the following hourly meteorological data: rainfall, wind speed, air relative humidity, air temperature and incoming solar radiation. Next, the water balance in the soil zone is computed on a daily basis using lumped-parameters and linear relationships between fluxes and soil moisture. The soil zone is discretized into superimposed layers that are parameterized with basic soil hydraulic properties (soil porosity, specific retention, wilting point, saturated hydraulic conductivity and thickness). The percolation from the soil zone into the intermediate unsaturated zone, i.e. the aeration zone between the soil bottom and the water table, is handled by the the MF package UZF1 (see http://pubs.usgs.gov/tm/2006/tm6a19/). UZF1 converts the soil percolation into groundwater recharge using a 1D solution of the Richard's equation that only considers gravitational forces. In this modeling approach, the capillary fringe is thus neglected. Finally, water flow and storage in the saturated zone are computed by MF. Since the MM-MF model is designed to represent phreatic aquifers, we use the MODFLOW-NWT version (see http://water.usgs.gov/nrp/gwsoftware/modflow_nwt/ModflowNwt.html). The transient calibration of the MM-MF coupled model is typically done against soil moisture in MM and hydraulic heads in MF.

The hydrological processes included in MM-MF are:

1 - Rainfall interception by vegetation and crops;
2 - Irrigation in agricultural fields;
3 - Potential evaporation and transpiration computed for several vegetation, crop and soil types;
4 - Infiltration, runoff, surface storage, evaporation, transpiration, percolation and soil moisture storage in the soil zone;
5 - Percolation and storage in the subsoil zone;
6 - Groundwater recharge, evaporation, transpiration, flow and storage of the saturated zone.

The items 1 to 3 are computed by MMsurf, while item 4 is computed by MMsoil. Item 5 is controlled by UZF1 while item 6 is computed by MODFLOW-NWT. The soil percolation computed by MMsoil is implemented in MF that convert it into groundwater recharge using the UZF1 package. In return, the depth of the water table and the groundwater exfiltration, computed by MF, constitutes the bottom boundary of MM.

MM-MF model output is a daily spatial water balance of the catchment that quantifies the partitioning of: (i) subsurface fluxes into unsaturated and saturated zone components; (ii) saturated zone fluxes into groundwater recharge, groundwater uptake by plants, direct evaporation from water table and groundwater runoff. Output are kept in HDF5 files (see http://www.hdfgroup.org/HDF5/) and they are automatically exported at user-defined observations points in ASCII files to allow their importing in other software such as Microsoft Excel. MM also produces images and plots to visualize spatial data and time series data.

Operationally, MM is programmed in Python and requires 3 types of ASCII files to run. The 1st type correspond to INI files that are required to initialize the 3 MM-MF components (MMsurf, MMsoil and MF). The 2nd ASCII file type is ESRI ASCII GRID, required to provide spatial parameters and variables to the MM-MF model. The 3rd type provides the times series of meteorological data, observations and other. To interact with MF, we use a Python pre and post-processor called FloPy (see https://modflowpy.github.io/flopydoc/index.html).
